---
    name: 'st2.webhook.cicd.events'
    description: 'Webhook listening for pushes to our CI/CD (SeatShare) repository'
    trigger:
        type: core.st2.webhook
        parameters:
            url: cicd/events
#    TODO Problem with X-GitHub-Event header in rule
#    Cannot seem to work as header or headers. Based on code, it looks like headers
#    actually do not go anywhere.
#    https://github.com/StackStorm/st2/blob/d6fab54e189c32e93843805ff17c8f8e86732939/st2api/st2api/controllers/v1/webhooks.py#L84
#    criteria:
#      "trigger.headers.X-GitHub-Event":
#          pattern: "push"
#          type: "eq"
    action:
        ref: jenkins.build_job
        parameters:
            project: "{{trigger.body.repository.name}}"
            branch: "{{trigger.body.ref}}"
    enabled: true
